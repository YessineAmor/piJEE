<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="../../../resources/templates/template_front.xhtml"
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="title"><title>Take Quiz</title></ui:define>

    <ui:define name="content">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.js"></script> 
        <h:outputScript name="js/jquery.steps.js" />
        <h:outputStylesheet name="css/jquery-steps.css"/>
        <!-- Start popular-post Area -->
        <section class="popular-post-area pt-100">
            <div class="container">
                <div class="row justify-content-center d-flex">
                    <div class="col-lg-12 post-list">          
                        <div class="single-post justify-content-center centerAll" >
                            <h:form>
                                <h:inputHidden id="selections" value="#{quizTryController.selections}"/>
                                <h:commandButton type="hidden" value="hahaha" action="#{quizTryController.submitTry(quizController.selected)}"></h:commandButton>
                            </h:form>
                            <div>
                                <h1>#{quizController.selected.name}</h1>
                            </div>
                            <div>
                                <h:outputText value="Minutes left: #{quizController.selected.duration}" id="duration"/>
                                <br></br>
                                <h:outputText value="Required score: #{quizController.selected.percentageToPass}%" />
                                <br></br>
                                <h:outputText value="Number of questions: #{questionController.getQuestionsByQuizId(quizController.firstQuiz.id).size()} " />
                                <br></br>
                                <br></br>
                            </div>

                            <div id="example-basic">
                                <ui:repeat value="#{questionController.getQuestionsByQuizId(quizController.selected.id)}" var="question" varStatus="status">
                                    <h3>#{question.questionText}</h3>
                                    <input title="#{question.idQuestion}" name="selectedChoices[]" type="hidden"/>
                                    <section class="everythingSection">
                                        <h3>#{question.questionText}</h3>
                                        <div class="choicesSection">
                                            <p>Please select an answer by clicking on the desired button.</p>
                                            <ui:repeat value="#{choiceController.getChoicesByQuestionId(question.idQuestion)}" var="choice">
                                                <h:outputLabel title="#{choice.idChoice}" role="#{question.idQuestion}" onclick="choiceClicked(#{choice.idChoice},#{question.idQuestion})" class="genric-btn success-border radius choiceElement" value="#{choice.choiceText}"/>
                                            </ui:repeat>
                                        </div>
                                    </section>
                                </ui:repeat>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- End popular-post Area -->

        <script type="text/javascript">
            $("#example-basic").steps({
                headerTag: "h3",
                bodyTag: "section",
                transitionEffect: "slideLeft",
                autoFocus: true,
                onFinished: function (event, currentIndex) {
                    var titles = $('input[name^=selectedChoices]').map(function (idx, elem) {
                        return $(elem).val();
                    }).get();

                    console.log(titles);
                    $("input[type='submit']").click();
                }
            });
            function choiceClicked(idchoice, idQuestion) {
                $("label[role=" + idQuestion + "]").removeClass().addClass("genric-btn success-border radius choiceElement");
                $("label[title=" + idchoice + "]").removeClass().addClass("genric-btn success radius choiceElement");
                $("input[title=" + idQuestion + "]").val(idchoice);
            }




        </script>

    </ui:define>


</ui:composition>
